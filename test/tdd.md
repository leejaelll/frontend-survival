# TDD

## í•™ìŠµ í‚¤ì›Œë“œ

* TDDë€
* Jest
* Describe - Context - It íŒ¨í„´
* ë‹¨ìœ„í…ŒìŠ¤íŠ¸ë€

{% hint style="danger" %}
**TDD ì— ëŒ€í•´ì„œ ì£¼ì˜í•  ì ** í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‘ì„±í•œë‹¤ê³  í•´ì„œ TDD ê°€ ì•„ë‹™ë‹ˆë‹¤. TDD Cycle ì— ë”°ë¼ í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ë¨¼ì € ì‘ì„±í•˜ê³ , êµ¬í˜„í•˜ê³ , ë¦¬íŒ©í„°ë§ í•˜ëŠ” ê³¼ì •ì„ ì—„ê²©í•˜ê²Œ ì§€ì¼œì„œ ê°œë°œì„ ì§„í–‰í•´ì•¼ TDD ë¼ê³  í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. TDD ëŠ” í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‘ì„±í•˜ëŠ” ê²ƒê³¼ ë³„ê°œë¡œ ë”°ë¡œ ì—°ìŠµì´ í•„ìš”í•˜ê³  ìŠµê´€ì„ ë“¤ì—¬ì•¼í•˜ëŠ” ë¶„ì•¼ ì…ë‹ˆë‹¤. ê·¸ë¦¬ê³  TDD ë¥¼ ì˜ í•˜ê¸° ìœ„í•´ì„œëŠ” í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‘ì„±ë²• ìì²´ë¶€í„° ê³µë¶€ë¥¼ í•˜ì…”ì•¼ í•©ë‹ˆë‹¤. ë‹¹ì¥ì€ TDD ë³´ë‹¤ í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‘ì„±ì— ìµìˆ™í•´ì§€ê³  ì–´ë–»ê²Œ í•˜ë©´ í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì˜ ì‘ì„±í•  ìˆ˜ ìˆì„ê¹Œì— ì´ˆì ì„ ë§ì¶° ê³µë¶€í•˜ì‹œë©´ ì¢‹ìŠµë‹ˆë‹¤.
{% endhint %}

* [í…ŒìŠ¤íŠ¸ ì£¼ë„ ê°œë°œ](https://github.com/ahastudio/til/blob/main/agile/test-driven-development.md)
* [TDD FAQ](https://github.com/ahastudio/til/blob/main/blog/2016/12-03-tdd-faq.md)
* [Jestë¥¼ ì´ìš©í•œ ê°„ë‹¨í•œ TDD ì˜ˆì œ](https://github.com/ahastudio/til/blob/main/jest/20201204-simple-tdd-example.md)

{% hint style="info" %}
#### TDD (Test Driven Development)

í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ë¨¼ì € ì‘ì„±í•˜ëŠ”, ì¦‰ êµ¬í˜„ë³´ë‹¤ ì¸í„°í˜ì´ìŠ¤ì™€ ìŠ¤í™ì„ ë¨¼ì € ì •ì˜í•¨ìœ¼ë¡œì¨ ê°œë°œì„ ì§„í–‰í•˜ëŠ” ë°©ì‹.

**ğŸš€ TDDë¥¼ ì‚¬ìš©í•˜ëŠ” ì´ìœ **

1. í…ŒìŠ¤íŠ¸ ì‘ì„±ì´ í”„ë¡œì„¸ìŠ¤ì˜ ì¼ë¶€ë¶„ì´ê¸° ë•Œë¬¸.
2. ì½”ë“œ ì‘ì„± ì „ì— í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‘ì„±í•˜ë©´ ìë™ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆë‹¤.
{% endhint %}

\\

**TDD Cycle**

1. Red â†’ ì‹¤íŒ¨í•˜ëŠ” í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‘ì„±. ì¸í„°í˜ì´ìŠ¤ì™€ ìŠ¤í™ì— ì§‘ì¤‘í•œë‹¤.
2. Green â†’ ì¬ë¹¨ë¦¬ í…ŒìŠ¤íŠ¸ë¥¼ í†µê³¼ì‹œí‚¨ë‹¤. ì˜¬ë°”ë¥¸ ë°©ë²•ì´ ì•„ë‹ˆì–´ë„ ê´œì°®ë‹¤. (ì½”ë“œ ì‘ì„± ì „ì— ì‹¤íŒ¨í•˜ëŠ” Red í…ŒìŠ¤íŠ¸ë¥¼ ë¨¼ì € ì‹¤í–‰í•˜ê³ , ì½”ë“œ ì‘ì„± í›„ì—ëŠ” í†µê³¼í•˜ëŠ” í…ŒìŠ¤íŠ¸ë¡œ Green í…ŒìŠ¤íŠ¸ë¥¼ í™•ì¸í•œë‹¤.)
3. Refactor â†’ ë¦¬íŒ©í„°ë§ì„ í†µí•´ ì½”ë“œë¥¼ ì˜¬ë°”ë¥´ê²Œ ë§Œë“ ë‹¤. TDDì—ì„œ ê°€ì¥ ì¤‘ìš”í•œ ë¶€ë¶„ì´ì§€ë§Œ, ê°„ê³¼ë  ë•Œê°€ ë§ë‹¤.

\\

### ì¤‘ìš”í•œ ê²ƒì€ ì‘ê²Œ ë§Œë“œëŠ” ê²ƒ!

ì‘ì€ ë‹¨ê³„ë¥¼ ì°¾ê³ , ì½”ë“œì—ì„œ í”¼ë“œë°±ì„ ì–»ëŠ” ê²Œ (ì–´ë µê³ ) ì¤‘ìš”í•˜ë‹¤. 2ë²ˆì´ ì–´ë µë‹¤ë©´ 1ë²ˆìœ¼ë¡œ ëŒì•„ê°€ì„œ ë” ì‘ê³  ì‰¬ìš´ ë¬¸ì œë¥¼ ì •ì˜í•˜ê³ , 3ë²ˆì„ ìœ„í•´ ì˜ë„ë¥¼ ë“œëŸ¬ë‚´ê³  ì¤‘ë³µì„ ì°¾ì•„ ì œê±°í•˜ëŠ” ì—°ìŠµì„ í•´ì•¼ í•œë‹¤. ì´ ë‘˜ì´ ìµìˆ™í•˜ì§€ ì•Šìœ¼ë©´ TDDë¥¼ í•˜ëŠ” ê²Œ ê±°ì˜ ë¶ˆê°€ëŠ¥í•˜ê³ , ì‚¬ì‹¤ ì´ ë‘˜ì´ ì–´ë ¤ìš°ë©´ ì¼ë°˜ì ì¸ ê°œë°œ ë˜ëŠ” í´ë¦° ì½”ë“œë¥¼ ì‘ì„±í•˜ëŠ” ê²ƒ ë˜í•œ ë§¤ìš° í˜ë“¤ë‹¤.

ğŸ‘‰ğŸ» ì‚¬ì‹¤ ì‘ì€ ë‹¨ê³„ë¥¼ ë§Œë“¤ê±°ë‚˜ ì¤‘ë³µì„ ì°¾ì•„ì„œ ì œê±°í•˜ëŠ” ê²ƒì´ ì–´ë ¤ìš´ ê±´ ê°œë°œì´ ì–´ë ¤ìš´ ê±°ë‚˜ ë§ˆì°¬ê°€ì§€.

\\

## Jest

* [Jest](https://jestjs.io/)
* [Given-When-Then](https://github.com/ahastudio/til/blob/main/blog/2018/12-08-given-when-then.md)

{% hint style="info" %}
#### âœ… Jestê°€ í•„ìš”í•œ ì´ìœ 

React Testing LibraryëŠ” ì»´í¬ë„ŒíŠ¸ë¥¼ ê°€ìƒ DOMì„ ë Œë”ë§í•˜ê³ , ê°€ìƒ DOMê³¼ ìƒí˜¸ì‘ìš©í•˜ëŠ”ë° ë„ì›€ì„ ì¤€ë‹¤. ì—¬ê¸°ê¹Œì§€ê°€ RTLì˜ ì—­í• ì¸ë° í…ŒìŠ¤íŠ¸ ëŸ¬ë„ˆê°€ í•„ìš”í•˜ë‹¤. í…ŒìŠ¤íŠ¸ë¥¼ ì°¾ê³  ì‹¤í–‰í•˜ë©°, ë‹¨ì–¸í•  ë¬´ì–¸ê°€ê°€ í•„ìš”í•œë° ì´ë•Œ Jestë¥¼ ì‚¬ìš©í•œë‹¤.
{% endhint %}

í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ë¥¼ ì •ì˜í•  ë•Œ í¬ê²Œ ë‘ ê°€ì§€ ë°©ë²•ì„ ì‚¬ìš©í•œë‹¤:

1. test í•¨ìˆ˜ë¡œ ê°œë³„ í…ŒìŠ¤íŠ¸ë¥¼ ë‚˜ì—´í•˜ëŠ” ë°©ì‹.
2. BDD ìŠ¤íƒ€ì¼ë¡œ ì£¼ì²´-í–‰ìœ„ ì¤‘ì‹¬ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ë¥¼ ì¡°ì§í™”í•˜ëŠ” ë°©ì‹.

\\

**ë¨¼ì € Jestê°€ ìˆëŠ”ì§€ í™•ì¸í•˜ê¸°**

jestì™€ @swc/jest ê°€ ì„¤ì¹˜ë˜ì–´ ìˆì–´ì•¼ í•œë‹¤.

\\

### ğŸ¦– @swc/jestì˜ ì—­í• 

* Jestìš© ì „ì²˜ë¦¬ê¸°ë¥¼ ì œê³µí•˜ëŠ” íŒ¨í‚¤ì§€
* Jestì—ì„œ í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰í•˜ê¸° ì „ì— SWC ì»´íŒŒì¼ëŸ¬ë¥¼ ì‚¬ìš©í•´ì„œ JavaScript ì½”ë“œë¡œ ë³€í™˜í•´ì¤€ë‹¤.

\\

ì²˜ìŒì—ëŠ” test í•¨ìˆ˜ë¡œ ê°œë³„ í…ŒìŠ¤íŠ¸ë¥¼ ì¨ë³´ì.

```jsx
test('add', () => {
  expect(add(1, 2)).toBe(3); // ê¸°ëŒ€í•œë‹¤. 1, 2ë¥¼ ë”í–ˆì„ ë•Œ 3ì´ ë ê±°ë¼ê³ !
});
```

ì´ ìƒíƒœë¡œ í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰í•˜ë©´ add í•¨ìˆ˜ê°€ ì •ì˜ë˜ì§€ ì•Šì•˜ë‹¤ëŠ” ì˜¤ë¥˜ë¥¼ ë°œìƒì‹œí‚¨ë‹¤.

![.](images/2023-04-06-15-04-17.png)

```tsx
function add(x: number, y: number) => {
	return 3;
}
```

\+) ë§Œì•½ íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì¸ì§€í•˜ì§€ ëª»í•´ì„œ ì˜¤ë¥˜ê°€ ë°œìƒí•œë‹¤ë©´ jest.config.jsíŒŒì¼ ì¶”ê°€í•˜ê¸°

Jestì—ì„œ TypeScript ì‚¬ìš©í•˜ë„ë¡ `jest.config.js` íŒŒì¼ ì‘ì„±

```jsx
module.exports = {
  testEnvironment: 'jsdom',
  setupFilesAfterEnv: ['@testing-library/jest-dom/extend-expect'],
  transform: {
    '^.+\\.(t|j)sx?$': [
      '@swc/jest',
      {
        // -> tsx ë˜ëŠ” jsx íŒŒì¼, x ë’¤ì— ë¬¼ìŒí‘œê°€ ë¶™ìœ¼ë©´ xê°€ ì—†ì„ ìˆ˜ë„ ìˆë‹¤ëŠ” ì˜ë¯¸
        jsc: {
          parser: {
            syntax: 'typescript',
            jsx: true,
            decorators: true,
          },
          transform: {
            react: {
              runtime: 'automatic',
            },
          },
        },
      },
    ],
  },
};
```

BDD ìŠ¤íƒ€ì¼ë¡œ í…ŒìŠ¤íŠ¸ ëŒ€ìƒê³¼ í–‰ìœ„ë¥¼ ëª…í™•íˆ ë“œëŸ¬ë‚´ì.

```jsx
describe('add', () => {
  // âœ… addë¼ëŠ” ê²ƒì„ í…ŒìŠ¤íŠ¸ í• ê±°ì•¼!
  it('returns sum of two numbers', () => {
    // âœ… addëŠ” ë¬´ì—‡ì„ í•˜ëŠ”ì§€ ì„¤ëª…í•œë‹¤.
    expect(add(1, 2)).toBe(3); // âœ… ë¬´ì—‡ì„ ê¸°ëŒ€í•˜ëŠ”ì§€ ì‘ì„±í•˜ê¸°
  });
});
```

\\

ë‹¤ì–‘í•œ ê²½ìš°ë¥¼ ê³ ë ¤í•´ ë³´ì.

ğŸ¤·ğŸ»â€â™€ï¸: ë‘ ìˆ«ìë§Œ ë”í•˜ëŠ”ê±° ì•„ë‹Œë°? ë“¤ì–´ì˜¤ëŠ” ìˆ«ìë“¤ ë‹¤ ë”í•˜ëŠ”ê±´ë°?

```jsx
function add(...numbers: number[]): number {
  return numbers.reduce((acc, cur) => acc + cur, 0); // âœ… ë¦¬íŒ©í† ë§ì˜ ê²°ê³¼ë¬¼!

  // refactoring ì „ ì½”ë“œ
  // return add(...numbers.slice(0, numbers.length - 1)) + numbers[numbers.length - 1]);
}

const context = describe;

describe('add', () => {
  context('with no argument', () => {
    it('returns zero', () => {
      expect(add()).toBe(0);
    });
  });

  context('with only one number', () => {
    it('returns the same number', () => {
      expect(add(1)).toBe(1);
    });
  });

  context('with two numbers', () => {
    it('returns sum of two numbers', () => {
      expect(add(1, 2)).toBe(3);
    });
  });

  context('with three numbers', () => {
    it('returns sum of three numbers', () => {
      expect(add(1, 2, 3)).toBe(6);
    });
  });
});
```

ì—¬ëŸ¬ ê°œì˜ í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ë¨¼ì € ì‘ì„±í•˜ê³  í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰í•˜ë©´ì„œ ì½”ë“œë¥¼ ë¦¬íŒ©í† ë§í•´ ë‚˜ê°ˆ ìˆ˜ ìˆë‹¤. ë˜í•œ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ë¥¼ ìƒê°í•˜ë©´ì„œ ì–´ë–¤ ê°’ë“¤ì´ ë“¤ì–´ì˜¬ ê²ƒ ê°™ì€ì§€ì— ëŒ€í•´ ìƒê°í•´ë³¼ ìˆ˜ ìˆë‹¤.

## ğŸ¦ logRoles

* getByRoleë¡œ í…ŒìŠ¤íŠ¸ ì¤‘ì¸ DOMì„ ì¿¼ë¦¬í•˜ëŠ” ë°©ë²•ì„ ì°¾ëŠ” ë° ìœ ìš©í•˜ë‹¤.

```tsx
import { logRoles } from '@testing-library/dom'; // ğŸš§ @testing-library/reactê°€ ì•„ë‹Œ @testing-library/domì—ì„œ ê°€ì ¸ì˜¤ëŠ” ê²ƒ ì£¼ì˜

const nav = document.createElement('nav');
nav.innerHTML = `
<ul>
  <li>Item 1</li>
  <li>Item 2</li>
</ul>`;

logRoles(nav);
```

Result:

```tsx
navigation:
<nav />
--------------------------------------------------
list:
<ul />
--------------------------------------------------
listitem:
<li />
<li />
--------------------------------------------------
```
